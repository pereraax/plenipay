(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4167],{8548:function(e,a,r){Promise.resolve().then(r.bind(r,79661))},79661:function(e,a,r){"use strict";r.r(a),r.d(a,{default:function(){return f}});var t=r(57437),i=r(2265),o=r(66424),s=r(9883),l=r(37189),n=r(6141),d=r(99670),c=r(53589),u=r(45367),m=r(82549),b=r(31541),x=r(92295),h=r(34599),g=r(53468);function f(){let[e,a]=(0,i.useState)([]),[r,f]=(0,i.useState)(!0),[v,p]=(0,i.useState)(!1),[j,N]=(0,i.useState)(null),[w,y]=(0,i.useState)({titulo:"",descricao:"",video_url:"",video_arquivo_url:"",thumbnail_url:"",categoria:"geral",ordem:0,duracao_segundos:"",ativo:!0}),[_,q]=(0,i.useState)(!1),[C,k]=(0,i.useState)(!1);(0,i.useEffect)(()=>{E()},[]);let E=async()=>{try{let e=(0,h.createClient)(),{data:r,error:t}=await e.from("tutoriais").select("*").order("ordem",{ascending:!0}).order("criado_em",{ascending:!1});t?(console.error("Erro ao carregar tutoriais:",t),(0,g.createNotification)("Erro ao carregar tutoriais","warning")):a(r||[])}catch(e){console.error("Erro ao carregar tutoriais:",e),(0,g.createNotification)("Erro ao carregar tutoriais","warning")}finally{f(!1)}},z=()=>{N(null),y({titulo:"",descricao:"",video_url:"",video_arquivo_url:"",thumbnail_url:"",categoria:"geral",ordem:e.length,duracao_segundos:"",ativo:!0}),p(!0)},T=e=>{var a;N(e),y({titulo:e.titulo,descricao:e.descricao||"",video_url:e.video_url||"",video_arquivo_url:e.video_arquivo_url||"",thumbnail_url:e.thumbnail_url||"",categoria:e.categoria||"geral",ordem:e.ordem,duracao_segundos:(null===(a=e.duracao_segundos)||void 0===a?void 0:a.toString())||"",ativo:e.ativo}),p(!0)},S=async()=>{if(!w.titulo.trim()){(0,g.createNotification)("T\xedtulo \xe9 obrigat\xf3rio","warning");return}try{let e=(0,h.createClient)(),{data:{user:a}}=await e.auth.getUser();if(!a){(0,g.createNotification)("N\xe3o autenticado","warning");return}let r={titulo:w.titulo.trim(),descricao:w.descricao.trim()||null,video_url:w.video_url.trim()||null,video_arquivo_url:w.video_arquivo_url.trim()||null,thumbnail_url:w.thumbnail_url.trim()||null,categoria:w.categoria||null,ordem:w.ordem,duracao_segundos:w.duracao_segundos?parseInt(w.duracao_segundos):null,ativo:w.ativo,criado_por:a.id};if(j){let{error:a}=await e.from("tutoriais").update(r).eq("id",j.id);if(a)throw a;(0,g.createNotification)("Tutorial atualizado com sucesso!","success")}else{let{error:a}=await e.from("tutoriais").insert([r]);if(a)throw a;(0,g.createNotification)("Tutorial criado com sucesso!","success")}p(!1),E()}catch(e){console.error("Erro ao salvar tutorial:",e),(0,g.createNotification)("Erro ao salvar tutorial: "+e.message,"warning")}},Z=async e=>{if(confirm("Tem certeza que deseja excluir este tutorial?"))try{let a=(0,h.createClient)(),{error:r}=await a.from("tutoriais").delete().eq("id",e);if(r)throw r;(0,g.createNotification)("Tutorial exclu\xeddo com sucesso!","success"),E()}catch(e){console.error("Erro ao excluir tutorial:",e),(0,g.createNotification)("Erro ao excluir tutorial: "+e.message,"warning")}},U=async e=>{var a;let r=null===(a=e.target.files)||void 0===a?void 0:a[0];if(r){q(!0);try{let e=(0,h.createClient)(),a=r.name.split(".").pop(),t="".concat(Date.now(),"_").concat(Math.random().toString(36).substring(7),".").concat(a),i="tutoriais/videos/".concat(t),{error:o}=await e.storage.from("emprestimos").upload(i,r);if(o)throw o;let{data:s}=e.storage.from("emprestimos").getPublicUrl(i);y({...w,video_arquivo_url:s.publicUrl}),(0,g.createNotification)("V\xeddeo enviado com sucesso!","success")}catch(e){console.error("Erro ao fazer upload do v\xeddeo:",e),(0,g.createNotification)("Erro ao fazer upload do v\xeddeo: "+e.message,"warning")}finally{q(!1)}}},D=async e=>{var a;let r=null===(a=e.target.files)||void 0===a?void 0:a[0];if(r){k(!0);try{let e=(0,h.createClient)(),a=r.name.split(".").pop(),t="".concat(Date.now(),"_").concat(Math.random().toString(36).substring(7),".").concat(a),i="tutoriais/thumbnails/".concat(t),{error:o}=await e.storage.from("emprestimos").upload(i,r);if(o)throw o;let{data:s}=e.storage.from("emprestimos").getPublicUrl(i);y({...w,thumbnail_url:s.publicUrl}),(0,g.createNotification)("Thumbnail enviada com sucesso!","success")}catch(e){console.error("Erro ao fazer upload da thumbnail:",e),(0,g.createNotification)("Erro ao fazer upload da thumbnail: "+e.message,"warning")}finally{k(!1)}}},V=e=>e?"".concat(Math.floor(e/60),":").concat((e%60).toString().padStart(2,"0")):"N/A";return(0,t.jsx)(o.default,{children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,t.jsxs)("div",{className:"mb-8 flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-display font-bold text-brand-clean mb-2",children:"Gerenciar Tutoriais"}),(0,t.jsx)("p",{className:"text-brand-clean/70",children:"Crie e gerencie os tutoriais da plataforma"})]}),(0,t.jsxs)("button",{onClick:z,className:"px-6 py-3 bg-brand-aqua text-brand-midnight rounded-xl font-semibold hover:bg-brand-aqua/90 transition-smooth flex items-center gap-2",children:[(0,t.jsx)(s.Z,{size:20}),"Novo Tutorial"]})]}),r?(0,t.jsx)("div",{className:"text-center py-12 text-brand-clean/60",children:"Carregando tutoriais..."}):0===e.length?(0,t.jsxs)("div",{className:"bg-brand-royal rounded-2xl p-12 text-center border border-white/10",children:[(0,t.jsx)(l.Z,{size:64,className:"mx-auto mb-4 text-brand-clean/30"}),(0,t.jsx)("p",{className:"text-brand-clean/60 text-lg mb-4",children:"Nenhum tutorial cadastrado"}),(0,t.jsxs)("button",{onClick:z,className:"px-6 py-3 bg-brand-aqua text-brand-midnight rounded-xl font-semibold hover:bg-brand-aqua/90 transition-smooth inline-flex items-center gap-2",children:[(0,t.jsx)(s.Z,{size:20}),"Criar Primeiro Tutorial"]})]}):(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(e=>(0,t.jsxs)("div",{className:"bg-brand-royal rounded-xl overflow-hidden border border-white/10 hover:border-brand-aqua/50 transition-smooth",children:[(0,t.jsxs)("div",{className:"relative aspect-video bg-gradient-to-br from-brand-aqua/20 to-brand-blue/20",children:[e.thumbnail_url?(0,t.jsx)("img",{src:e.thumbnail_url,alt:e.titulo,className:"w-full h-full object-cover"}):(0,t.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,t.jsx)(l.Z,{size:48,className:"text-brand-aqua/50"})}),!e.ativo&&(0,t.jsx)("div",{className:"absolute top-2 right-2 bg-red-500 text-white text-xs px-2 py-1 rounded",children:"Inativo"})]}),(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsx)("h3",{className:"text-lg font-display text-brand-clean mb-2 line-clamp-2",children:e.titulo}),e.descricao&&(0,t.jsx)("p",{className:"text-sm text-brand-clean/70 mb-3 line-clamp-2",children:e.descricao}),(0,t.jsxs)("div",{className:"flex items-center justify-between text-xs text-brand-clean/60 mb-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(n.Z,{size:12}),V(e.duracao_segundos)]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(d.Z,{size:12}),e.visualizacoes]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)("button",{onClick:()=>T(e),className:"flex-1 px-3 py-2 bg-brand-aqua/20 text-brand-aqua rounded-lg hover:bg-brand-aqua/30 transition-smooth flex items-center justify-center gap-1 text-sm",children:[(0,t.jsx)(c.Z,{size:16}),"Editar"]}),(0,t.jsx)("button",{onClick:()=>Z(e.id),className:"px-3 py-2 bg-red-500/20 text-red-400 rounded-lg hover:bg-red-500/30 transition-smooth",children:(0,t.jsx)(u.Z,{size:16})})]})]})]},e.id))}),v&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4",children:(0,t.jsxs)("div",{className:"bg-brand-royal rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto border border-white/10",children:[(0,t.jsxs)("div",{className:"sticky top-0 bg-brand-royal border-b border-white/10 px-6 py-4 flex items-center justify-between",children:[(0,t.jsx)("h2",{className:"text-xl font-display text-brand-clean",children:j?"Editar Tutorial":"Novo Tutorial"}),(0,t.jsx)("button",{onClick:()=>p(!1),className:"p-2 hover:bg-white/10 rounded-lg transition-smooth",children:(0,t.jsx)(m.Z,{size:20,className:"text-brand-clean"})})]}),(0,t.jsxs)("div",{className:"p-6 space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-brand-clean mb-2",children:"T\xedtulo *"}),(0,t.jsx)("input",{type:"text",value:w.titulo,onChange:e=>y({...w,titulo:e.target.value}),className:"w-full px-4 py-2 bg-brand-midnight border border-white/10 rounded-lg text-brand-clean focus:outline-none focus:border-brand-aqua",placeholder:"Ex: Como criar uma d\xedvida"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-brand-clean mb-2",children:"Descri\xe7\xe3o"}),(0,t.jsx)("textarea",{value:w.descricao,onChange:e=>y({...w,descricao:e.target.value}),rows:3,className:"w-full px-4 py-2 bg-brand-midnight border border-white/10 rounded-lg text-brand-clean focus:outline-none focus:border-brand-aqua resize-none",placeholder:"Descri\xe7\xe3o do tutorial..."})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-brand-clean mb-2",children:"Categoria"}),(0,t.jsxs)("select",{value:w.categoria,onChange:e=>y({...w,categoria:e.target.value}),className:"w-full px-4 py-2 bg-brand-midnight border border-white/10 rounded-lg text-brand-clean focus:outline-none focus:border-brand-aqua",children:[(0,t.jsx)("option",{value:"geral",children:"Geral"}),(0,t.jsx)("option",{value:"dividas",children:"D\xedvidas"}),(0,t.jsx)("option",{value:"metas",children:"Metas"}),(0,t.jsx)("option",{value:"calendario",children:"Calend\xe1rio"}),(0,t.jsx)("option",{value:"dashboard",children:"Dashboard"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-brand-clean mb-2",children:"Ordem"}),(0,t.jsx)("input",{type:"number",value:w.ordem,onChange:e=>y({...w,ordem:parseInt(e.target.value)||0}),className:"w-full px-4 py-2 bg-brand-midnight border border-white/10 rounded-lg text-brand-clean focus:outline-none focus:border-brand-aqua"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-brand-clean mb-2",children:"URL do V\xeddeo (YouTube, Vimeo, etc.)"}),(0,t.jsx)("input",{type:"url",value:w.video_url,onChange:e=>y({...w,video_url:e.target.value}),className:"w-full px-4 py-2 bg-brand-midnight border border-white/10 rounded-lg text-brand-clean focus:outline-none focus:border-brand-aqua",placeholder:"https://youtube.com/watch?v=..."})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-brand-clean mb-2",children:"Upload de V\xeddeo"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("label",{className:"flex-1 px-4 py-2 bg-brand-midnight border border-white/10 rounded-lg text-brand-clean cursor-pointer hover:bg-brand-midnight/80 transition-smooth flex items-center justify-center gap-2",children:[(0,t.jsx)(b.Z,{size:18}),_?"Enviando...":"Escolher Arquivo",(0,t.jsx)("input",{type:"file",accept:"video/*",onChange:U,className:"hidden",disabled:_})]}),w.video_arquivo_url&&(0,t.jsx)("span",{className:"text-xs text-brand-clean/60",children:"âœ“ V\xeddeo enviado"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-brand-clean mb-2",children:"Upload de Thumbnail"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("label",{className:"flex-1 px-4 py-2 bg-brand-midnight border border-white/10 rounded-lg text-brand-clean cursor-pointer hover:bg-brand-midnight/80 transition-smooth flex items-center justify-center gap-2",children:[(0,t.jsx)(b.Z,{size:18}),C?"Enviando...":"Escolher Imagem",(0,t.jsx)("input",{type:"file",accept:"image/*",onChange:D,className:"hidden",disabled:C})]}),w.thumbnail_url&&(0,t.jsx)("div",{className:"w-12 h-12 rounded overflow-hidden border border-white/10",children:(0,t.jsx)("img",{src:w.thumbnail_url,alt:"Thumbnail",className:"w-full h-full object-cover"})})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-brand-clean mb-2",children:"Dura\xe7\xe3o (segundos)"}),(0,t.jsx)("input",{type:"number",value:w.duracao_segundos,onChange:e=>y({...w,duracao_segundos:e.target.value}),className:"w-full px-4 py-2 bg-brand-midnight border border-white/10 rounded-lg text-brand-clean focus:outline-none focus:border-brand-aqua",placeholder:"Ex: 300 (5 minutos)"})]}),(0,t.jsx)("div",{className:"flex items-center pt-8",children:(0,t.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,t.jsx)("input",{type:"checkbox",checked:w.ativo,onChange:e=>y({...w,ativo:e.target.checked}),className:"w-4 h-4 rounded border-white/20 bg-brand-midnight text-brand-aqua focus:ring-brand-aqua"}),(0,t.jsx)("span",{className:"text-sm text-brand-clean",children:"Tutorial ativo"})]})})]}),(0,t.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,t.jsx)("button",{onClick:()=>p(!1),className:"flex-1 px-4 py-2 bg-brand-midnight text-brand-clean rounded-lg hover:bg-brand-midnight/80 transition-smooth",children:"Cancelar"}),(0,t.jsxs)("button",{onClick:S,className:"flex-1 px-4 py-2 bg-brand-aqua text-brand-midnight rounded-lg font-semibold hover:bg-brand-aqua/90 transition-smooth flex items-center justify-center gap-2",children:[(0,t.jsx)(x.Z,{size:18}),"Salvar"]})]})]})]})})]})})}}},function(e){e.O(0,[4962,889,3468,3347,2971,4938,1744],function(){return e(e.s=8548)}),_N_E=e.O()}]);