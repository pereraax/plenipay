"use strict";exports.id=8827,exports.ids=[8827],exports.modules={53257:(e,r,a)=>{a.d(r,{Z:()=>m});var o=a(95344),i=a(3729),t=a(7060),n=a(71206),s=a(14513),l=a(66138),c=a(27100),d=a(67857),u=a(36234);function m({email:e,onConfirmado:r,onClose:a,obrigatorio:m=!0}){let[g,f]=(0,i.useState)(["","","","","","","",""]),[p,x]=(0,i.useState)(!1),[b,h]=(0,i.useState)(!1),[v,y]=(0,i.useState)(""),[w,E]=(0,i.useState)(0),[D,C]=(0,i.useState)(!1),[j,N]=(0,i.useState)(!1),T=(0,i.useRef)([]),S=(0,i.useRef)("");(0,i.useEffect)(()=>{T.current[0]?.focus()},[]),(0,i.useEffect)(()=>{if(w>0){let e=setTimeout(()=>{E(w-1)},1e3);return()=>clearTimeout(e)}},[w]);let P=(e,r)=>{if(r&&!/^\d$/.test(r))return;let a=[...g];a[e]=r,f(a),y(""),console.log(`üìù Digitando no campo ${e+1}/8. Valor: ${r}. C\xf3digo atual: ${a.join("")}`),r&&e<7?setTimeout(()=>{let r=T.current[e+1];r?(r.focus(),console.log(`‚û°Ô∏è Foco movido para campo ${e+2}/8`)):console.error(`‚ùå N\xe3o foi poss\xedvel mover foco para campo ${e+2}/8`)},10):r&&7===e&&console.log(`‚úÖ Todos os 8 d\xedgitos foram preenchidos!`);let o=a.join("");console.log(`üìä Comprimento do c\xf3digo: ${o.length} d\xedgitos`),8===o.length?(console.log(`üîÑ C\xf3digo completo detectado: ${o}. Iniciando verifica\xe7\xe3o...`),o===S.current||j||(S.current=o,setTimeout(()=>{k(o)},300))):6===o.length&&console.log(`‚ö†Ô∏è C\xf3digo tem 6 d\xedgitos. Aguardando mais 2 d\xedgitos...`)},$=(e,r)=>{if("Backspace"===r.key&&g[e]){let r=[...g];r[e]="",f(r)}else"Backspace"===r.key&&!g[e]&&e>0?T.current[e-1]?.focus():"ArrowLeft"===r.key&&e>0?T.current[e-1]?.focus():"ArrowRight"===r.key&&e<7&&T.current[e+1]?.focus()},q=e=>{e.preventDefault();let r=e.clipboardData.getData("text").trim();/^\d{6}$/.test(r)?(f([...r.split(""),"",""]),y(""),T.current[5]?.focus(),setTimeout(()=>k(r),100)):/^\d{8}$/.test(r)&&(f(r.split("")),y(""),T.current[7]?.focus(),setTimeout(()=>k(r),100))},k=async a=>{let o=a||g.join("").replace(/\s/g,"");if(o.length<6){y("Por favor, insira pelo menos 6 d\xedgitos do c\xf3digo");return}if(o.length>8)return k(o.substring(0,8));if(7===o.length){y("C\xf3digo incompleto. Digite todos os 8 d\xedgitos.");return}if(j&&S.current===o){console.log("‚ö†Ô∏è C\xf3digo j\xe1 foi verificado, ignorando...");return}x(!0),y(""),N(!0);try{console.log("\uD83D\uDD0D Iniciando verifica\xe7\xe3o do c\xf3digo..."),console.log("\uD83D\uDCE7 Email:",e),console.log("\uD83D\uDD22 C\xf3digo inserido:",o,`(${o.length} d\xedgitos)`);let a=(0,u.createClient)(),i=null,t=null;console.log(`üîÑ Verificando c\xf3digo: ${o} (${o.length} d\xedgitos)`),console.log(`üìß Email: ${e}`),console.log(`‚è∞ Timestamp: ${new Date().toISOString()}`);let n=["email","signup"],s=null,l=!1;if(8===o.length){l=!0;for(let r=0;r<n.length;r++){let l=n[r];if(console.log(`üîÑ Tentativa ${r+1}: Verificando c\xf3digo COMPLETO (8 d\xedgitos: ${o}) com type '${l}'`),!(s=await a.auth.verifyOtp({email:e,token:o,type:l})).error&&s.data?.user){i=s.data,t=null,console.log(`‚úÖ‚úÖ‚úÖ SUCESSO com c\xf3digo COMPLETO (8 d\xedgitos) e type '${l}'!`);break}{let e=s.error?.code||"";if(console.log(`‚ùå Tentativa ${r+1} (${l}, 8 d\xedgitos) falhou:`,s.error?.message),"otp_expired"===e){t=s.error,console.error("‚ö†Ô∏è C\xf3digo expirado - n\xe3o tentar mais");break}t||(t=s.error)}}}if(t&&(l||6===o.length)&&t?.code!=="otp_expired"){let r=o.substring(0,6);console.log(`üîÑ Tentando com primeiros 6 d\xedgitos: ${r}`);for(let o=0;o<n.length;o++){let l=n[o];if(console.log(`üîÑ Tentativa ${o+1}: Verificando 6 d\xedgitos (${r}) com type '${l}'`),!(s=await a.auth.verifyOtp({email:e,token:r,type:l})).error&&s.data?.user){i=s.data,t=null,console.log(`‚úÖ‚úÖ‚úÖ SUCESSO com 6 d\xedgitos e type '${l}'!`);break}{let e=s.error?.code||"";if(console.log(`‚ùå Tentativa ${o+1} (${l}, 6 d\xedgitos) falhou:`,s.error?.message),"otp_expired"===e){t=s.error;break}t||(t=s.error)}}}if(t&&!i&&(t=s?.error||t),t){console.error("‚ùå Todas as tentativas falharam. Erro final:",t),console.error("\uD83D\uDCCB Detalhes do erro:",JSON.stringify(t,null,2));let e=t?.code||"";"otp_expired"===e&&(N(!1),S.current="");let r="Erro ao verificar c\xf3digo. Tente novamente.",a=t.message||"";"otp_expired"===e||a.includes("expired")||a.includes("expir")?(r="C\xf3digo expirado. Solicite um novo c\xf3digo.",f(["","","","","","","",""])):"otp_invalid"===e||a.includes("invalid")||a.includes("incorrect")?r="‚ùå C\xf3digo inv\xe1lido. Verifique se digitou corretamente ou solicite um novo c\xf3digo.":a.includes("not found")||a.includes("does not exist")?r="\uD83D\uDD0D C\xf3digo n\xe3o encontrado. Solicite um novo c\xf3digo.":a&&(r=a),y(r),f(["","","","","","","",""]),T.current[0]?.focus()}else i?.user?i.user.email_confirmed_at?(console.log("‚úÖ Email confirmado com sucesso!"),console.log("\uD83D\uDC64 User ID:",i.user.id),C(!0),setTimeout(()=>{r()},2500)):(console.warn("‚ö†Ô∏è Email ainda n\xe3o confirmado ap\xf3s verifica\xe7\xe3o OTP"),y("Email ainda n\xe3o foi confirmado. Tente novamente."),f(["","","","","","","",""]),T.current[0]?.focus()):(console.error("‚ùå Verifica\xe7\xe3o retornou sem usu\xe1rio"),y("Erro ao confirmar email. Tente novamente."),f(["","","","","","","",""]),T.current[0]?.focus())}catch(e){console.error("‚ùå Erro inesperado:",e),y("Erro inesperado. Tente novamente.")}finally{x(!1)}},O=e=>{if(e<60)return`${e} segundo${1!==e?"s":""}`;let r=Math.floor(e/60),a=e%60;return 0===a?`${r} minuto${1!==r?"s":""}`:`${r} minuto${1!==r?"s":""} e ${a} segundo${1!==a?"s":""}`},I=async()=>{if(!(w>0)){N(!1),S.current="",h(!0),y("");try{let r=await (0,d.DR)(e);if(r.error){let e=r.error.match(/(?:after|ap√≥s|em|wait|aguarde|ap√≥s)\s*(\d+)\s*(?:segundo|segundos|second|seconds|s)/i)||r.error.match(/(\d+)\s*(?:segundo|segundos|second|seconds)/i),a=60;e&&(a=parseInt(e[1])),E(a);let o=r.error;r.error.includes("rate limit")||r.error.includes("too many")?o=`Muitas tentativas. Aguarde ${O(a)} antes de tentar novamente.`:(r.error.includes("after")||r.error.includes("seconds"))&&(o=`Por seguran\xe7a, voc\xea s\xf3 pode solicitar um novo c\xf3digo ap\xf3s ${O(a)}.`),y(o)}else(0,c.createNotification)("C\xf3digo reenviado! Verifique seu email.","success"),f(["","","","","","","",""]),T.current[0]?.focus(),E(60)}catch(e){y("Erro ao reenviar c\xf3digo. Tente novamente."),console.error("Erro ao reenviar c\xf3digo:",e),E(60)}finally{h(!1)}}};return D?o.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-md z-[9999] flex items-center justify-center p-4 animate-fade-in",children:(0,o.jsxs)("div",{className:"bg-gradient-to-br from-brand-royal to-brand-midnight rounded-xl max-w-xs w-full shadow-2xl animate-slide-up overflow-hidden border border-brand-aqua/40",onClick:e=>e.stopPropagation(),children:[o.jsx("div",{className:"px-4 py-3 border-b border-brand-aqua/20 bg-brand-midnight/30",children:(0,o.jsxs)("div",{className:"flex items-center gap-2.5",children:[o.jsx("div",{className:"w-9 h-9 bg-green-500/25 rounded-lg flex items-center justify-center flex-shrink-0",children:o.jsx(t.Z,{size:18,className:"text-green-400"})}),(0,o.jsxs)("div",{className:"flex-1 min-w-0",children:[o.jsx("h2",{className:"text-base font-display text-brand-clean leading-tight",children:"Email Confirmado!"}),o.jsx("p",{className:"text-[11px] text-brand-clean/50 leading-tight mt-0.5",children:"Redirecionando..."})]})]})}),o.jsx("div",{className:"p-4 space-y-3.5 bg-brand-royal/50 text-center",children:(0,o.jsxs)("div",{className:"space-y-2",children:[o.jsx("div",{className:"w-16 h-16 bg-green-500/20 rounded-full flex items-center justify-center mx-auto",children:o.jsx(t.Z,{size:32,className:"text-green-400"})}),o.jsx("p",{className:"text-sm text-brand-clean font-semibold",children:"Seu email foi confirmado com sucesso!"}),o.jsx("p",{className:"text-xs text-brand-clean/70",children:"Voc\xea ser\xe1 redirecionado para a p\xe1gina inicial em instantes..."})]})})]})}):o.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-md z-[9999] flex items-center justify-center p-4 animate-fade-in",onClick:e=>{m&&e.target===e.currentTarget&&(e.preventDefault(),e.stopPropagation())},children:(0,o.jsxs)("div",{className:"bg-gradient-to-br from-brand-royal to-brand-midnight rounded-xl max-w-xs w-full shadow-2xl animate-slide-up overflow-hidden border border-brand-aqua/40",onClick:e=>e.stopPropagation(),children:[o.jsx("div",{className:"px-4 py-3 border-b border-brand-aqua/20 bg-brand-midnight/30",children:(0,o.jsxs)("div",{className:"flex items-center gap-2.5",children:[o.jsx("div",{className:"w-9 h-9 bg-brand-aqua/25 rounded-lg flex items-center justify-center flex-shrink-0",children:o.jsx(n.Z,{size:18,className:"text-brand-aqua"})}),(0,o.jsxs)("div",{className:"flex-1 min-w-0",children:[o.jsx("h2",{className:"text-base font-display font-bold text-brand-clean leading-tight",children:"Confirmar Email"}),o.jsx("p",{className:"text-[11px] text-brand-clean/50 leading-tight mt-0.5",children:m?"Confirme para continuar":"Verifique sua caixa"})]}),a&&!m&&o.jsx("button",{onClick:a,className:"p-1 hover:bg-brand-aqua/10 rounded transition-smooth flex-shrink-0",children:o.jsx(s.Z,{size:16,className:"text-brand-clean/50"})})]})}),(0,o.jsxs)("div",{className:"p-5 space-y-4 bg-brand-royal/50",children:[(0,o.jsxs)("div",{className:"space-y-2",children:[o.jsx("p",{className:"text-xs text-brand-clean/70 font-medium text-center",children:"C\xf3digo enviado para:"}),o.jsx("p",{className:"text-brand-aqua font-semibold text-sm break-all text-center px-2",children:e}),m&&(0,o.jsxs)("div",{className:"flex items-center justify-center gap-1.5 mt-2",children:[o.jsx(l.Z,{size:14,className:"text-orange-400"}),o.jsx("p",{className:"text-xs text-orange-400 font-medium",children:"Confirme para acessar todas as funcionalidades"})]})]}),(0,o.jsxs)("div",{className:"space-y-3",children:[o.jsx("p",{className:"text-xs text-brand-clean/70 font-medium text-center",children:"Digite o c\xf3digo de 8 d\xedgitos:"}),o.jsx("div",{className:"flex justify-center gap-2",children:g.slice(0,6).map((e,r)=>o.jsx("input",{ref:e=>{T.current[r]=e},type:"text",inputMode:"numeric",maxLength:1,value:e,onChange:e=>P(r,e.target.value),onKeyDown:e=>$(r,e),onPaste:0===r?q:void 0,className:"w-10 h-12 text-center text-lg font-bold bg-brand-midnight/70 border-2 border-brand-aqua/40 rounded-lg focus:outline-none focus:border-brand-aqua focus:ring-2 focus:ring-brand-aqua/30 transition-smooth text-brand-clean",disabled:p},r))}),o.jsx("div",{className:"flex justify-center gap-2",children:g.slice(6,8).map((e,r)=>{let a=r+6;return o.jsx("input",{ref:e=>{T.current[a]=e},type:"text",inputMode:"numeric",maxLength:1,value:e,onChange:e=>P(a,e.target.value),onKeyDown:e=>$(a,e),className:"w-10 h-12 text-center text-lg font-bold bg-brand-midnight/70 border-2 border-brand-aqua/40 rounded-lg focus:outline-none focus:border-brand-aqua focus:ring-2 focus:ring-brand-aqua/30 transition-smooth text-brand-clean",disabled:p},a)})})]}),v&&(0,o.jsxs)("div",{className:"flex items-start gap-2 text-red-300 bg-red-900/30 rounded-lg px-3 py-2.5 border border-red-800/40",children:[o.jsx(l.Z,{size:16,className:"flex-shrink-0 mt-0.5"}),o.jsx("span",{className:"text-xs leading-relaxed",children:v})]}),(0,o.jsxs)("div",{className:"space-y-2",children:[o.jsx("button",{onClick:()=>k(),disabled:p||g.join("").length<8,className:"w-full px-4 py-3 bg-brand-aqua text-brand-midnight rounded-lg font-semibold hover:bg-brand-aqua/90 shadow-lg hover:shadow-xl transition-smooth disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 text-sm",children:p?(0,o.jsxs)(o.Fragment,{children:[o.jsx("div",{className:"w-4 h-4 border-2 border-brand-midnight border-t-transparent rounded-full animate-spin"}),"Verificando..."]}):(0,o.jsxs)(o.Fragment,{children:[o.jsx(t.Z,{size:18}),"Verificar C\xf3digo"]})}),!m&&a&&o.jsx("button",{onClick:a,className:"w-full px-4 py-2.5 bg-gray-100 dark:bg-white/10 text-gray-700 dark:text-brand-clean rounded-lg font-medium hover:bg-gray-200 dark:hover:bg-white/20 transition-smooth text-sm",children:"Verificar Depois"})]}),(0,o.jsxs)("div",{className:"pt-2 border-t border-brand-aqua/20 space-y-2",children:[o.jsx("button",{onClick:I,disabled:b||w>0,className:"w-full text-xs text-brand-aqua hover:text-brand-aqua/80 font-medium transition-smooth disabled:opacity-50 disabled:cursor-not-allowed underline",children:b?"Reenviando...":w>0?`Aguarde ${O(w)}`:"N\xe3o recebeu? Reenviar c\xf3digo"}),w>0&&(0,o.jsxs)("p",{className:"text-[10px] text-brand-clean/50 text-center",children:["Voc\xea pode solicitar um novo c\xf3digo em ",O(w)]})]}),o.jsx("div",{className:"bg-brand-aqua/10 rounded-lg px-3 py-2.5 border border-brand-aqua/20",children:o.jsx("p",{className:"text-xs text-brand-clean/60 text-center leading-relaxed",children:"\uD83D\uDCA1 Verifique tamb\xe9m a pasta de spam"})})]})]})})}},67857:(e,r,a)=>{a.d(r,{CJ:()=>l,DR:()=>s,r7:()=>i,w7:()=>n,y1:()=>t}),a(13664);var o=a(28371),i=(0,o.$)("af57716356d6711de19f4b294ef38dab29192658"),t=(0,o.$)("5fb0b12f705d3fe03212a5331f7a911301d2812e");(0,o.$)("c16d528f90e3db723b94995b14058d08a9e8cf84");var n=(0,o.$)("11f8fca4417732546fe912dbec8867545b1420e2");(0,o.$)("d2d951da07170bc91f02c3b5699d2504d05516ec"),(0,o.$)("f532c4a12438cd423ff5c6045bf57e0314f36d60"),(0,o.$)("a6b95364239244383532b3cd7632bc70ec94d971");var s=(0,o.$)("31619cab705d1fa7f986f3a2c91dc3f433eb1871"),l=(0,o.$)("97b3fc9fcfd85871864875d29a6f848768ae3f09")},95884:(e,r,a)=>{a.r(r),a.d(r,{atualizarSenha:()=>f,getCurrentUser:()=>d,getCurrentUserProfile:()=>u,reenviarCodigoEmail:()=>g,reenviarEmailConfirmacao:()=>p,signIn:()=>l,signOut:()=>c,signUp:()=>s,verificarCodigoEmail:()=>m});var o=a(98601);a(75811);var i=a(25345),t=a(43811),n=a(54276);async function s(e,r,a,o,t,n){try{let s=await (0,i.createClient)(),{data:l,error:c}=await s.auth.signUp({email:e,password:r,options:{data:{nome:a,telefone:o,whatsapp:t,plano:n,email:e},emailRedirectTo:"https://plenipay.com.br/auth/callback?next=/home"}});if(l?.user&&!l.user.email_confirmed_at&&(console.log("‚úÖ Usu\xe1rio criado. OTP foi enviado automaticamente pelo signUp."),console.log("\uD83D\uDCE7 Verifique o email:",e),console.log("‚è∞ Use o c\xf3digo imediatamente ap\xf3s receber (c\xf3digos expiram rapidamente)"),console.log("‚ö†Ô∏è IMPORTANTE: N\xe3o reenviar OTP manualmente para evitar rate limit")),c){if(console.error("Erro ao criar usu\xe1rio no Auth:",c),console.error("Detalhes do erro:",JSON.stringify(c,null,2)),c.message.includes("rate limit")||c.message.includes("rate_limit")||c.message.includes("too many")||c.message.includes("email rate limit exceeded"))return console.warn("‚ö†Ô∏è Rate limit atingido - n\xe3o \xe9 poss\xedvel criar conta no momento"),console.warn("‚ö†Ô∏è O usu\xe1rio precisa aguardar alguns minutos ou verificar email depois"),{error:"Limite de envio de emails atingido temporariamente. O limite reseta automaticamente a cada 15 minutos. Por favor, aguarde e tente novamente em alguns minutos.",rateLimit:!0};if(c.message.includes("Error sending confirmation email")||c.message.includes("sending confirmation email")||c.message.includes("email sending failed"))return console.warn("‚ö†Ô∏è Erro ao enviar email de confirma\xe7\xe3o - isso geralmente significa que SMTP n\xe3o est\xe1 configurado ou h\xe1 problema na configura\xe7\xe3o"),{error:'Erro ao enviar email de confirma\xe7\xe3o. Por favor, desabilite a confirma\xe7\xe3o de email no Supabase Dashboard (Authentication ‚Üí URL Configuration ‚Üí Desabilite "Enable email confirmations") ou configure o SMTP corretamente.',emailError:!0};if(c.message.includes("already registered")||c.message.includes("already exists"))return{error:"Este email j\xe1 est\xe1 cadastrado. Tente fazer login ou use outro email."};if(c.message.includes("Database error")||c.message.includes("relation")||c.message.includes("does not exist"))return{error:"Erro no banco de dados. Verifique se executou os scripts SQL no Supabase (supabase-schema.sql e supabase-auth-schema.sql)."};if(c.message.includes("Invalid email"))return{error:"Email inv\xe1lido. Verifique o formato do email."};if(c.message.includes("password"))return{error:"A senha deve ter pelo menos 6 caracteres."};return{error:c.message||"Erro desconhecido ao criar conta. Verifique o console para mais detalhes."}}if(!l.user)return console.error("Usu\xe1rio n\xe3o foi criado no Auth"),{error:"Erro ao criar usu\xe1rio. Tente novamente."};await new Promise(e=>setTimeout(e,1500));let{data:d,error:u}=await s.from("profiles").select("*").eq("id",l.user.id).single();if(u&&"PGRST116"!==u.code&&console.error("Erro ao verificar perfil:",u),d&&d.email&&""!==d.email)console.log("Perfil j\xe1 existe e est\xe1 completo");else{let{error:r}=await s.from("profiles").upsert({id:l.user.id,email:e,nome:a,telefone:o,whatsapp:t,plano:n},{onConflict:"id"});if(r){if(console.error("Erro ao criar/atualizar perfil (fallback):",r),console.error("Detalhes do erro de perfil:",JSON.stringify(r,null,2)),r.message.includes("permission")||r.message.includes("policy")||r.message.includes("RLS"))console.warn("Erro de permiss\xe3o RLS. Verifique se as pol\xedticas RLS est\xe3o configuradas corretamente.");else{if(r.message.includes("relation")||r.message.includes("does not exist"))return console.error("‚ùå ERRO CR\xcdTICO: Tabela profiles n\xe3o existe! Execute o script supabase-auth-schema.sql no Supabase."),{error:"Banco de dados n\xe3o configurado. Execute os scripts SQL no Supabase (supabase-schema.sql e supabase-auth-schema.sql)."};console.warn("Perfil n\xe3o foi criado/atualizado, mas o usu\xe1rio foi criado. Verifique o trigger no Supabase.")}}else console.log("Perfil criado/atualizado com sucesso (fallback)")}let m=null!==l.user.email_confirmed_at;return console.log("‚úÖ Usu\xe1rio criado com sucesso:",l.user.id),console.log("\uD83D\uDCE7 Email:",l.user.email),console.log("‚úÖ Email confirmado:",m),console.log("\uD83D\uDCEC OTP enviado:",m?"N\xc3O (j\xe1 confirmado)":"SIM (aguardando confirma\xe7\xe3o)"),m||(console.log('‚ö†Ô∏è IMPORTANTE: Verifique se "Enable email confirmations" est\xe1 habilitado no Supabase Dashboard'),console.log("‚ö†Ô∏è Verifique tamb\xe9m se SMTP est\xe1 configurado ou se est\xe1 usando o servi\xe7o padr\xe3o do Supabase")),{data:l,emailConfirmado:m}}catch(e){return console.error("Erro inesperado no signUp:",e),{error:e.message||"Erro inesperado ao criar conta"}}}async function l(e,r){try{let a=await (0,i.createClient)(),{data:o,error:n}=await a.auth.signInWithPassword({email:e,password:r});if(n){if(console.error("Erro ao fazer login:",n),console.error("Detalhes do erro:",JSON.stringify(n,null,2)),n.message.includes("Invalid login credentials"))return{error:"Email ou senha incorretos"};if(n.message.includes("Email not confirmed"))return{error:"Por favor, confirme seu email antes de fazer login. Verifique sua caixa de entrada."};return{error:n.message}}if(!o.user)return console.error("Usu\xe1rio n\xe3o retornado ap\xf3s login"),{error:"Erro ao fazer login. Tente novamente."};o.user.email_confirmed_at||console.warn("Email n\xe3o confirmado ainda - permitindo login mas lembrando de verificar"),console.log("Login bem-sucedido para usu\xe1rio:",o.user.id),console.log("Email confirmado:",!!o.user.email_confirmed_at),console.log("Session:",o.session?"existe":"n\xe3o existe");let{data:s,error:l}=await a.from("profiles").select("*").eq("id",o.user.id).single();return l&&"PGRST116"!==l.code?console.warn("Perfil n\xe3o encontrado, mas login foi bem-sucedido:",l):s?console.log("Perfil encontrado:",s.email):console.warn("‚ö†Ô∏è Perfil n\xe3o encontrado para o usu\xe1rio:",o.user.id),(0,t.revalidatePath)("/","layout"),(0,t.revalidatePath)("/home","layout"),(0,t.revalidatePath)("/registros","layout"),(0,t.revalidatePath)("/dividas","layout"),(0,t.revalidatePath)("/calendario","layout"),(0,t.revalidatePath)("/dashboard","layout"),(0,t.revalidatePath)("/configuracoes","layout"),{data:o,session:o.session,user:o.user}}catch(e){return console.error("Erro inesperado no signIn:",e),{error:e.message||"Erro inesperado ao fazer login"}}}async function c(){let e=await (0,i.createClient)();await e.auth.signOut(),(0,t.revalidatePath)("/"),(0,n.redirect)("/login")}async function d(){try{let e=await (0,i.createClient)(),{data:{user:r},error:a}=await e.auth.getUser();if(a)return null;return r}catch(e){return null}}async function u(){let e=await (0,i.createClient)(),{data:{user:r}}=await e.auth.getUser();if(!r)return null;let{data:a,error:o}=await e.from("profiles").select("*").eq("id",r.id).single();return o||!a?null:a}async function m(e,r){try{let a=await (0,i.createClient)();console.log("\uD83D\uDD10 Verificando c\xf3digo OTP..."),console.log("\uD83D\uDCE7 Email:",r),console.log("\uD83D\uDD22 C\xf3digo recebido:",e,`(${e.length} d\xedgitos)`);let o=null,n=null;console.log(`üîÑ Tentativa 1: Verificando com c\xf3digo completo e type 'signup'`);let s=await a.auth.verifyOtp({email:r,token:e,type:"signup"});if(!s.error&&s.data?.user)o=s.data,console.log("‚úÖ Sucesso na tentativa 1 (type signup)");else if(n=s.error,console.log(`‚ùå Tentativa 1 falhou:`,n?.message),e.length>=6){let i=e.substring(0,6);console.log(`üîÑ Tentativa 2: Verificando com primeiros 6 d\xedgitos (${i}) e type 'signup'`);let t=await a.auth.verifyOtp({email:r,token:i,type:"signup"});if(!t.error&&t.data?.user)o=t.data,n=null,console.log("‚úÖ Sucesso na tentativa 2 (6 d\xedgitos, type signup)");else{console.log(`‚ùå Tentativa 2 falhou:`,t.error?.message),n=t.error||n,console.log(`üîÑ Tentativa 3: Verificando com c\xf3digo completo e type 'email'`);let i=await a.auth.verifyOtp({email:r,token:e,type:"email"});if(!i.error&&i.data?.user)o=i.data,n=null,console.log("‚úÖ Sucesso na tentativa 3 (type email)");else if(console.log(`‚ùå Tentativa 3 falhou:`,i.error?.message),n=i.error||n,e.length>=6){let i=e.substring(0,6);console.log(`üîÑ Tentativa 4: Verificando com primeiros 6 d\xedgitos (${i}) e type 'email'`);let t=await a.auth.verifyOtp({email:r,token:i,type:"email"});!t.error&&t.data?.user?(o=t.data,n=null,console.log("‚úÖ Sucesso na tentativa 4 (6 d\xedgitos, type email)")):(console.log(`‚ùå Tentativa 4 falhou:`,t.error?.message),n=t.error||n)}}}if(n){if(console.error("‚ùå Todas as tentativas falharam. Erro final:",n),console.error("\uD83D\uDCCB Detalhes do erro:",JSON.stringify(n,null,2)),n.message.includes("expired")||n.message.includes("expir"))return{error:"C\xf3digo expirado. Solicite um novo c\xf3digo."};if(n.message.includes("invalid")||n.message.includes("incorrect"))return{error:"C\xf3digo inv\xe1lido. Verifique e tente novamente."};if(n.message.includes("not found")||n.message.includes("does not exist"))return{error:"C\xf3digo n\xe3o encontrado. Solicite um novo c\xf3digo."};return{error:n.message||"Erro ao verificar c\xf3digo. Tente solicitar um novo c\xf3digo."}}if(!o?.user)return console.error("‚ùå Nenhum usu\xe1rio retornado ap\xf3s verifica\xe7\xe3o"),{error:"Erro ao verificar c\xf3digo. Tente novamente."};if(!o.user.email_confirmed_at)return console.warn("‚ö†Ô∏è Email ainda n\xe3o confirmado ap\xf3s verifica\xe7\xe3o OTP"),{error:"Email ainda n\xe3o foi confirmado. Tente novamente."};return console.log("‚úÖ Email confirmado com sucesso!"),console.log("\uD83D\uDC64 User ID:",o.user.id),(0,t.revalidatePath)("/"),{data:o,success:!0}}catch(e){return console.error("‚ùå Erro inesperado ao verificar c\xf3digo:",e),{error:e.message||"Erro inesperado ao verificar c\xf3digo"}}}async function g(e){try{let r=await (0,i.createClient)(),{error:a}=await r.auth.resend({type:"signup",email:e});if(a&&(console.log("Tentando reenviar com type: signup..."),a=(await r.auth.resend({type:"signup",email:e})).error),a){if(console.error("Erro ao reenviar c\xf3digo:",a),console.error("Detalhes do erro:",JSON.stringify(a,null,2)),a.message.includes("rate limit")||a.message.includes("too many"))return{error:"Muitas tentativas. Aguarde alguns minutos antes de tentar novamente."};if(a.message.includes("not found")||a.message.includes("does not exist"))return{error:"Email n\xe3o encontrado. Verifique se o email est\xe1 correto."};return{error:a.message||"Erro ao reenviar c\xf3digo. Verifique a configura\xe7\xe3o do Supabase."}}return console.log("‚úÖ C\xf3digo OTP reenviado com sucesso para:",e),{success:!0}}catch(e){return console.error("Erro inesperado ao reenviar c\xf3digo:",e),{error:e.message||"Erro inesperado ao reenviar c\xf3digo"}}}async function f(e,r){try{let a=await (0,i.createClient)(),{data:{user:o}}=await a.auth.getUser();if(!o||!o.email)return{error:"Usu\xe1rio n\xe3o encontrado"};let{error:t}=await a.auth.signInWithPassword({email:o.email,password:e});if(t)return{error:"Senha atual incorreta"};let{error:n}=await a.auth.updateUser({password:r});if(n)return console.error("Erro ao atualizar senha:",n),{error:n.message};return{success:!0}}catch(e){return console.error("Erro inesperado ao atualizar senha:",e),{error:e.message||"Erro inesperado ao atualizar senha"}}}async function p(){try{let e=await (0,i.createClient)(),{data:{user:r}}=await e.auth.getUser();if(!r||!r.email)return{error:"Usu\xe1rio n\xe3o encontrado"};let{error:a}=await e.auth.resend({type:"signup",email:r.email});if(a)return console.error("Erro ao reenviar email de confirma\xe7\xe3o:",a),{error:a.message};return{success:!0}}catch(e){return console.error("Erro inesperado ao reenviar email:",e),{error:e.message||"Erro inesperado ao reenviar email"}}}(0,a(46893).ensureServerEntryExports)([s,l,c,d,u,m,g,f,p]),(0,o.createActionProxy)("5fb0b12f705d3fe03212a5331f7a911301d2812e",s),(0,o.createActionProxy)("c16d528f90e3db723b94995b14058d08a9e8cf84",l),(0,o.createActionProxy)("11f8fca4417732546fe912dbec8867545b1420e2",c),(0,o.createActionProxy)("d2d951da07170bc91f02c3b5699d2504d05516ec",d),(0,o.createActionProxy)("f532c4a12438cd423ff5c6045bf57e0314f36d60",u),(0,o.createActionProxy)("a6b95364239244383532b3cd7632bc70ec94d971",m),(0,o.createActionProxy)("31619cab705d1fa7f986f3a2c91dc3f433eb1871",g),(0,o.createActionProxy)("97b3fc9fcfd85871864875d29a6f848768ae3f09",f),(0,o.createActionProxy)("af57716356d6711de19f4b294ef38dab29192658",p)},25345:(e,r,a)=>{a.d(r,{createClient:()=>t});var o=a(95827),i=a(19053);let t=(0,a(15028).cache)(async()=>{let e=await (0,i.cookies)();return(0,o.createServerClient)("https://frhxqgcqmxpjpnghsvoe.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZyaHhxZ2NxbXhwanBuZ2hzdm9lIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM2NTM3NTYsImV4cCI6MjA3OTIyOTc1Nn0.p1OxLRA5DKgvetuy-IbCfYClNSjrvK6fm43aZNX3T7I",{cookies:{getAll:()=>e.getAll(),setAll(r){try{r.forEach(({name:r,value:a,options:o})=>e.set(r,a,o))}catch{}}}})})}};