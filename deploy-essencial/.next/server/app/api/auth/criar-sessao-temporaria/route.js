"use strict";(()=>{var e={};e.id=1292,e.ids=[1292],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},72426:(e,r,s)=>{s.r(r),s.d(r,{headerHooks:()=>d,originalPathname:()=>x,patchFetch:()=>g,requestAsyncStorage:()=>l,routeModule:()=>m,serverHooks:()=>h,staticGenerationAsyncStorage:()=>I,staticGenerationBailout:()=>f});var o={};s.r(o),s.d(o,{POST:()=>p});var a=s(95419),t=s(69108),i=s(99678),n=s(78070),c=s(81664),u=s(94128);async function p(e){try{let{email:r,password:s}=await e.json();if(!r||!s)return n.Z.json({error:"Email e senha s\xe3o obrigat\xf3rios"},{status:400});let o=(0,c.i3)();if(!o)return n.Z.json({error:"Service Role Key n\xe3o configurada. Configure SUPABASE_SERVICE_ROLE_KEY no .env.local"},{status:500});let{data:a,error:t}=await o.auth.admin.listUsers();if(t)return console.error("Erro ao listar usu\xe1rios:",t),n.Z.json({error:"Erro ao verificar usu\xe1rio"},{status:500});if(!a.users.find(e=>e.email?.toLowerCase()===r.toLowerCase()))return n.Z.json({error:"Email ou senha incorretos"},{status:401});let i=(0,u.eI)("https://frhxqgcqmxpjpnghsvoe.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZyaHhxZ2NxbXhwanBuZ2hzdm9lIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM2NTM3NTYsImV4cCI6MjA3OTIyOTc1Nn0.p1OxLRA5DKgvetuy-IbCfYClNSjrvK6fm43aZNX3T7I"),{data:p,error:m}=await i.auth.signInWithPassword({email:r,password:s});if(m&&(m.message.includes("Email not confirmed")||m.message.includes("email_not_confirmed"))){console.log("⚠️ Email n\xe3o confirmado - criando sess\xe3o tempor\xe1ria SEM confirmar email...");try{let{data:e,error:s}=await o.auth.admin.generateLink({type:"magiclink",email:r,options:{redirectTo:"https://plenipay.com.br/home"}});if(s)return console.error("Erro ao gerar link de sess\xe3o:",s),n.Z.json({error:"N\xe3o foi poss\xedvel criar sess\xe3o tempor\xe1ria. Por favor, confirme seu email primeiro."},{status:500});return n.Z.json({error:"email_not_confirmed",message:"Por favor, confirme seu email para acessar todas as funcionalidades."},{status:401})}catch(e){return console.error("Erro ao tentar criar sess\xe3o tempor\xe1ria:",e),n.Z.json({error:"Erro ao criar sess\xe3o. Por favor, confirme seu email primeiro."},{status:500})}}else if(m)return n.Z.json({error:m.message||"Email ou senha incorretos"},{status:401});if(p?.session&&p?.user)return n.Z.json({success:!0,session:{access_token:p.session.access_token,refresh_token:p.session.refresh_token,expires_at:p.session.expires_at,expires_in:p.session.expires_in,token_type:p.session.token_type,user:p.user},user:p.user,emailConfirmed:!0});return n.Z.json({error:"Erro ao processar login"},{status:500})}catch(e){return console.error("Erro na API criar-sessao-temporaria:",e),n.Z.json({error:e.message||"Erro interno do servidor"},{status:500})}}let m=new a.AppRouteRouteModule({definition:{kind:t.x.APP_ROUTE,page:"/api/auth/criar-sessao-temporaria/route",pathname:"/api/auth/criar-sessao-temporaria",filename:"route",bundlePath:"app/api/auth/criar-sessao-temporaria/route"},resolvedPagePath:"/Users/charllestabordas/Documents/SISTEMA DE CONTAS/app/api/auth/criar-sessao-temporaria/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:l,staticGenerationAsyncStorage:I,serverHooks:h,headerHooks:d,staticGenerationBailout:f}=m,x="/api/auth/criar-sessao-temporaria/route";function g(){return(0,i.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:I})}},81664:(e,r,s)=>{s.d(r,{eI:()=>i,i3:()=>n,vv:()=>c});var o=s(77497),a=s(94128),t=s(32455);let i=(0,s(40002).cache)(async()=>{let e=await (0,t.cookies)();return(0,o.createServerClient)("https://frhxqgcqmxpjpnghsvoe.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZyaHhxZ2NxbXhwanBuZ2hzdm9lIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM2NTM3NTYsImV4cCI6MjA3OTIyOTc1Nn0.p1OxLRA5DKgvetuy-IbCfYClNSjrvK6fm43aZNX3T7I",{cookies:{getAll:()=>e.getAll(),setAll(r){try{r.forEach(({name:r,value:s,options:o})=>e.set(r,s,o))}catch{}}}})});function n(){let e=process.env.SUPABASE_SERVICE_ROLE_KEY;return e?(0,a.eI)("https://frhxqgcqmxpjpnghsvoe.supabase.co",e,{auth:{autoRefreshToken:!1,persistSession:!1}}):null}function c(){return(0,a.eI)("https://frhxqgcqmxpjpnghsvoe.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZyaHhxZ2NxbXhwanBuZ2hzdm9lIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM2NTM3NTYsImV4cCI6MjA3OTIyOTc1Nn0.p1OxLRA5DKgvetuy-IbCfYClNSjrvK6fm43aZNX3T7I",{auth:{autoRefreshToken:!1,persistSession:!1}})}},50482:(e,r,s)=>{e.exports=s(20399)},40002:(e,r,s)=>{e.exports=s(50482).vendored["react-rsc"].React},95419:(e,r,s)=>{e.exports=s(30517)}};var r=require("../../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),o=r.X(0,[1638,2455,4128,7497,8070],()=>s(72426));module.exports=o})();