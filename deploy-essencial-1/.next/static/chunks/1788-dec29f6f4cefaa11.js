(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1788],{72894:function(e,a,t){"use strict";t.d(a,{Z:function(){return r}});/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,t(62898).Z)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},28203:function(e,a,t){"use strict";t.d(a,{Z:function(){return r}});/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,t(62898).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},71738:function(e,a,t){"use strict";t.d(a,{Z:function(){return r}});/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,t(62898).Z)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},49168:function(e,a,t){"use strict";t.d(a,{Z:function(){return r}});/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,t(62898).Z)("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]])},50774:function(e,a,t){"use strict";t.d(a,{Z:function(){return r}});/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,t(62898).Z)("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]])},86264:function(e,a,t){"use strict";t.d(a,{Z:function(){return r}});/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,t(62898).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},1295:function(e,a,t){"use strict";t.d(a,{Z:function(){return r}});/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,t(62898).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},41827:function(e,a,t){"use strict";t.d(a,{Z:function(){return r}});/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,t(62898).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},76020:function(e,a,t){"use strict";t.d(a,{Z:function(){return r}});/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,t(62898).Z)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]])},29409:function(e,a,t){"use strict";t.d(a,{Z:function(){return r}});/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,t(62898).Z)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},67972:function(e,a,t){"use strict";t.d(a,{Z:function(){return r}});/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,t(62898).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},11788:function(e,a,t){Promise.resolve().then(t.bind(t,68319))},68319:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return k}});var r=t(57437),s=t(2265),n=t(41827),d=t(50774),l=t(1295);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,t(62898).Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);var o=t(28203),c=t(86264),x=t(49168),m=t(17961),b=t(82836),h=t(67972),u=t(82549),p=t(72894),g=t(71738),j=t(29409),f=t(76020);let y={teste:"bg-orange-900/30 text-orange-400 border-orange-800/50",basico:"bg-blue-900/30 text-blue-400 border-blue-800/50",premium:"bg-purple-900/30 text-purple-400 border-purple-800/50"},N={teste:"Teste",basico:"B\xe1sico",premium:"Premium"};function v(e){let{usuario:a,onClose:t}=e,[n,v]=(0,s.useState)(!1),[k,w]=(0,s.useState)(!1),[C,Z]=(0,s.useState)(!1),[_,z]=(0,s.useState)((null==a?void 0:a.plano)||"teste"),[q,S]=(0,s.useState)("ativo"),[T,E]=(0,s.useState)(null);if(!a)return null;let P=a.last_sign_in_at?Math.floor((new Date().getTime()-new Date(a.last_sign_in_at).getTime())/864e5)>=7:Math.floor((new Date().getTime()-new Date(a.created_at).getTime())/864e5)>=7,M=a.last_sign_in_at?Math.floor((new Date().getTime()-new Date(a.last_sign_in_at).getTime())/864e5):Math.floor((new Date().getTime()-new Date(a.created_at).getTime())/864e5),A=async()=>{v(!0),E(null);try{let e=await fetch("/api/admin/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a.email})}),t=await e.json();e.ok?E({tipo:"success",texto:"Link de recupera\xe7\xe3o de senha enviado com sucesso!"}):E({tipo:"error",texto:t.error||"Erro ao enviar link de recupera\xe7\xe3o"})}catch(e){E({tipo:"error",texto:"Erro ao conectar com o servidor"})}finally{v(!1)}},L=async()=>{if(a){w(!0),E(null);try{let e=await fetch("/api/admin/alterar-plano",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:a.id,plano:_,planoStatus:q})}),t=await e.json();e.ok?(E({tipo:"success",texto:"Plano alterado para ".concat(N[_]," com sucesso!")}),a.plano=_,Z(!1),setTimeout(()=>{window.location.reload()},1500)):E({tipo:"error",texto:t.error||"Erro ao alterar plano"})}catch(e){E({tipo:"error",texto:"Erro ao conectar com o servidor"})}finally{w(!1)}}};return(0,r.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 animate-fade-in",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:t}),(0,r.jsxs)("div",{className:"relative bg-white dark:bg-brand-royal rounded-2xl shadow-2xl border border-gray-200 dark:border-white/10 w-full max-w-lg max-h-[85vh] overflow-hidden animate-slide-up",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between px-5 py-4 border-b border-gray-200 dark:border-white/10 bg-white dark:bg-brand-midnight",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"p-2 bg-brand-aqua/20 rounded-xl",children:(0,r.jsx)(h.Z,{size:24,className:"text-brand-aqua"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-xl font-display font-bold text-brand-clean",children:"Detalhes do Usu\xe1rio"}),(0,r.jsx)("p",{className:"text-sm text-brand-clean/60",children:"Informa\xe7\xf5es completas"})]})]}),(0,r.jsx)("button",{onClick:t,className:"p-2 hover:bg-white/10 rounded-xl transition-smooth",children:(0,r.jsx)(u.Z,{size:20,className:"text-brand-clean/60"})})]}),(0,r.jsxs)("div",{className:"px-5 py-4 overflow-y-auto max-h-[calc(85vh-200px)] bg-white dark:bg-brand-royal",children:[T&&(0,r.jsx)("div",{className:"mb-3 p-3 rounded-lg border text-xs ".concat("success"===T.tipo?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800 text-green-700 dark:text-green-400":"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800 text-red-700 dark:text-red-400"),children:T.texto}),P&&(0,r.jsx)("div",{className:"mb-4 p-4 bg-orange-50 dark:bg-orange-900/20 border-2 border-orange-300 dark:border-orange-700 rounded-xl",children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)("div",{className:"p-2 bg-orange-500/20 dark:bg-orange-500/30 rounded-lg",children:(0,r.jsx)(p.Z,{size:20,className:"text-orange-600 dark:text-orange-400",strokeWidth:2.5})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h4",{className:"font-bold text-orange-800 dark:text-orange-300 mb-1",children:"Usu\xe1rio Inativo"}),(0,r.jsx)("p",{className:"text-sm text-orange-700 dark:text-orange-400",children:a.last_sign_in_at?"Este usu\xe1rio n\xe3o faz login h\xe1 ".concat(M," ").concat(1===M?"dia":"dias","."):"Este usu\xe1rio nunca fez login. Cadastrado h\xe1 ".concat(M," ").concat(1===M?"dia":"dias",".")})]})]})}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"bg-gray-50 dark:bg-brand-midnight/50 rounded-lg p-3 border border-gray-200 dark:border-white/10",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-1.5",children:[(0,r.jsx)(d.Z,{size:16,className:"text-brand-aqua"}),(0,r.jsx)("label",{className:"text-xs font-medium text-brand-midnight dark:text-brand-clean/70",children:"ID Admin"})]}),(0,r.jsxs)("p",{className:"text-sm font-mono text-brand-midnight dark:text-brand-clean font-semibold",children:["#",a.id_curto||a.id.substring(0,5)]}),(0,r.jsxs)("p",{className:"text-xs font-mono text-brand-midnight/50 dark:text-brand-clean/50 break-all mt-1",children:["UUID: ",a.id]})]}),(0,r.jsxs)("div",{className:"bg-gray-50 dark:bg-brand-midnight/50 rounded-lg p-3 border border-gray-200 dark:border-white/10",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-1.5",children:[(0,r.jsx)(h.Z,{size:16,className:"text-brand-aqua"}),(0,r.jsx)("label",{className:"text-xs font-medium text-brand-midnight dark:text-brand-clean/70",children:"Nome Completo"})]}),(0,r.jsx)("p",{className:"text-sm font-medium text-brand-midnight dark:text-brand-clean",children:a.nome})]}),(0,r.jsxs)("div",{className:"bg-gray-50 dark:bg-brand-midnight/50 rounded-lg p-3 border border-gray-200 dark:border-white/10",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-1.5",children:[(0,r.jsx)(l.Z,{size:16,className:"text-brand-aqua"}),(0,r.jsx)("label",{className:"text-xs font-medium text-brand-midnight dark:text-brand-clean/70",children:"Email"})]}),(0,r.jsx)("p",{className:"text-sm text-brand-midnight dark:text-brand-clean",children:a.email})]}),(0,r.jsxs)("div",{className:"bg-gray-50 dark:bg-brand-midnight/50 rounded-lg p-3 border border-gray-200 dark:border-white/10",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)(i,{size:16,className:"text-brand-aqua"}),(0,r.jsx)("label",{className:"text-xs font-medium text-brand-midnight dark:text-brand-clean/70",children:"Contatos"})]}),(0,r.jsxs)("div",{className:"space-y-1.5",children:[a.telefone&&(0,r.jsxs)("div",{className:"flex items-center gap-2 text-xs text-brand-midnight dark:text-brand-clean/80",children:[(0,r.jsx)(i,{size:12,className:"text-brand-midnight/60 dark:text-brand-clean/60"}),(0,r.jsxs)("span",{children:["Telefone: ",a.telefone]})]}),a.whatsapp&&(0,r.jsxs)("div",{className:"flex items-center gap-2 text-xs text-brand-midnight dark:text-brand-clean/80",children:[(0,r.jsx)(i,{size:12,className:"text-brand-midnight/60 dark:text-brand-clean/60"}),(0,r.jsxs)("span",{children:["WhatsApp: ",a.whatsapp]})]}),!a.telefone&&!a.whatsapp&&(0,r.jsx)("span",{className:"text-xs text-brand-midnight/40 dark:text-brand-clean/40",children:"Nenhum contato cadastrado"})]})]}),(0,r.jsxs)("div",{className:"bg-gray-50 dark:bg-brand-midnight/50 rounded-lg p-3 border border-gray-200 dark:border-white/10",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(g.Z,{size:16,className:"text-brand-aqua"}),(0,r.jsx)("label",{className:"text-xs font-medium text-brand-midnight dark:text-brand-clean/70",children:"Plano Atual"})]}),(0,r.jsxs)("button",{onClick:()=>{z(a.plano),Z(!C)},className:"px-2 py-1 bg-brand-aqua/20 text-brand-aqua rounded-lg hover:bg-brand-aqua/30 transition-smooth text-xs font-medium flex items-center gap-1",children:[(0,r.jsx)(j.Z,{size:12}),"Alterar"]})]}),(0,r.jsx)("span",{className:"inline-block px-2.5 py-1 rounded-full text-xs font-medium border ".concat(y[a.plano]),children:N[a.plano]}),C&&(0,r.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-white/10 space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs font-medium text-brand-midnight dark:text-brand-clean/70 mb-2",children:"Novo Plano"}),(0,r.jsxs)("select",{value:_,onChange:e=>z(e.target.value),className:"w-full px-3 py-2 bg-white dark:bg-brand-midnight border border-gray-300 dark:border-white/20 rounded-lg text-sm text-brand-midnight dark:text-brand-clean focus:outline-none focus:border-brand-aqua",children:[(0,r.jsx)("option",{value:"teste",children:"Teste (Gratuito)"}),(0,r.jsx)("option",{value:"basico",children:"B\xe1sico (R$ 39,00/m\xeas)"}),(0,r.jsx)("option",{value:"premium",children:"Premium (R$ 59,00/m\xeas)"})]})]}),("basico"===_||"premium"===_)&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs font-medium text-brand-midnight dark:text-brand-clean/70 mb-2",children:"Status do Plano"}),(0,r.jsxs)("select",{value:q,onChange:e=>S(e.target.value),className:"w-full px-3 py-2 bg-white dark:bg-brand-midnight border border-gray-300 dark:border-white/20 rounded-lg text-sm text-brand-midnight dark:text-brand-clean focus:outline-none focus:border-brand-aqua",children:[(0,r.jsx)("option",{value:"trial",children:"Trial (Teste)"}),(0,r.jsx)("option",{value:"ativo",children:"Ativo"}),(0,r.jsx)("option",{value:"cancelado",children:"Cancelado"}),(0,r.jsx)("option",{value:"expirado",children:"Expirado"})]})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:L,disabled:k||_===a.plano,className:"flex-1 px-3 py-2 bg-brand-aqua text-white rounded-lg hover:bg-brand-aqua/90 transition-smooth text-sm font-medium flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:k?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.Z,{size:14,className:"animate-spin"}),"Alterando..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(x.Z,{size:14}),"Confirmar Altera\xe7\xe3o"]})}),(0,r.jsx)("button",{onClick:()=>{Z(!1),z(a.plano)},className:"px-3 py-2 bg-gray-100 dark:bg-brand-royal text-brand-midnight dark:text-brand-clean rounded-lg hover:bg-gray-200 dark:hover:bg-white/10 transition-smooth text-sm font-medium",children:"Cancelar"})]})]})]}),(0,r.jsxs)("div",{className:"bg-gray-50 dark:bg-brand-midnight/50 rounded-lg p-3 border border-gray-200 dark:border-white/10",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-1.5",children:[(0,r.jsx)(o.Z,{size:16,className:"text-brand-aqua"}),(0,r.jsx)("label",{className:"text-xs font-medium text-brand-midnight dark:text-brand-clean/70",children:"Cadastrado em"})]}),(0,r.jsx)("p",{className:"text-sm text-brand-midnight dark:text-brand-clean",children:(0,m.WU)(new Date(a.created_at),"dd 'de' MMMM 'de' yyyy '\xe0s' HH:mm",{locale:b.F})})]}),(0,r.jsxs)("div",{className:"bg-gray-50 dark:bg-brand-midnight/50 rounded-lg p-3 border border-gray-200 dark:border-white/10",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-1.5",children:[(0,r.jsx)(o.Z,{size:16,className:"text-brand-aqua"}),(0,r.jsx)("label",{className:"text-xs font-medium text-brand-midnight dark:text-brand-clean/70",children:"\xdaltimo Login"})]}),(0,r.jsx)("p",{className:"text-sm text-brand-midnight dark:text-brand-clean",children:a.last_sign_in_at?(0,m.WU)(new Date(a.last_sign_in_at),"dd 'de' MMMM 'de' yyyy '\xe0s' HH:mm",{locale:b.F}):(0,r.jsx)("span",{className:"text-orange-600 dark:text-orange-400 font-medium",children:"Nunca fez login"})})]})]})]}),(0,r.jsxs)("div",{className:"px-5 py-4 border-t border-gray-200 dark:border-white/10 flex items-center justify-between gap-3 bg-white dark:bg-brand-midnight",children:[(0,r.jsx)("button",{onClick:t,className:"px-4 py-2 bg-gray-100 dark:bg-brand-royal text-brand-midnight dark:text-brand-clean rounded-lg hover:bg-gray-200 dark:hover:bg-white/10 transition-smooth font-medium text-sm border border-gray-200 dark:border-white/10",children:"Fechar"}),(0,r.jsx)("button",{onClick:A,disabled:n,className:"px-4 py-2 bg-brand-aqua text-brand-midnight rounded-lg hover:bg-brand-aqua/90 transition-smooth font-medium flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:n?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.Z,{size:16,className:"animate-spin"}),"Enviando..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(f.Z,{size:16}),"Enviar Link de Recupera\xe7\xe3o"]})})]})]})]})}function k(e){let{usuarios:a,error:t}=e,[h,u]=(0,s.useState)(""),[p,g]=(0,s.useState)("todos"),[j,f]=(0,s.useState)(null),[y,N]=(0,s.useState)(null),[k,w]=(0,s.useState)(null),[C,Z]=(0,s.useState)(null),_=(0,s.useMemo)(()=>a.filter(e=>{let a=e.nome.toLowerCase().includes(h.toLowerCase())||e.email.toLowerCase().includes(h.toLowerCase())||e.id.toLowerCase().includes(h.toLowerCase())||e.id_curto&&e.id_curto.toLowerCase().includes(h.toLowerCase()),t="todos"===p||e.plano===p;return a&&t}),[a,h,p]),z={teste:"bg-orange-900/30 text-orange-400 border-orange-800/50",basico:"bg-blue-900/30 text-blue-400 border-blue-800/50",premium:"bg-purple-900/30 text-purple-400 border-purple-800/50"},q={teste:"Teste",basico:"B\xe1sico",premium:"Premium"},S=async(e,a)=>{if(e.plano!==a){N(e.id),Z(null);try{let t=await fetch("/api/admin/alterar-plano",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e.id,plano:a,planoStatus:"teste"===a?"trial":"ativo"})}),r=await t.json();t.ok?(Z({tipo:"success",texto:"Plano de ".concat(e.nome," alterado para ").concat(q[a],"!")}),setTimeout(()=>{Z(null),window.location.reload()},1500)):(Z({tipo:"error",texto:r.error||"Erro ao alterar plano"}),setTimeout(()=>Z(null),5e3))}catch(e){Z({tipo:"error",texto:"Erro ao conectar com o servidor"}),setTimeout(()=>Z(null),5e3)}finally{N(null)}}};return(0,r.jsxs)("div",{className:"space-y-6",children:[C&&(0,r.jsx)("div",{className:"p-4 rounded-xl border ".concat("success"===C.tipo?"bg-green-900/20 border-green-800/50 text-green-400":"bg-red-900/20 border-red-800/50 text-red-400"),children:(0,r.jsx)("p",{className:"text-sm font-medium",children:C.texto})}),(0,r.jsxs)("div",{className:"bg-brand-royal rounded-2xl p-4 shadow-lg border border-white/10",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(n.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-brand-clean/60",size:20}),(0,r.jsx)("input",{type:"text",value:h,onChange:e=>u(e.target.value),placeholder:"Buscar por nome, email ou ID...",className:"w-full pl-10 pr-4 py-3 bg-brand-midnight border border-white/20 rounded-xl focus:outline-none focus:border-brand-aqua transition-smooth text-brand-clean placeholder-brand-clean/50"})]}),(0,r.jsxs)("select",{value:p,onChange:e=>g(e.target.value),className:"px-4 py-3 bg-brand-midnight border border-white/20 rounded-xl focus:outline-none focus:border-brand-aqua transition-smooth text-brand-clean",children:[(0,r.jsx)("option",{value:"todos",children:"Todos os Planos"}),(0,r.jsx)("option",{value:"teste",children:"Teste"}),(0,r.jsx)("option",{value:"basico",children:"B\xe1sico"}),(0,r.jsx)("option",{value:"premium",children:"Premium"})]})]}),(0,r.jsxs)("div",{className:"mt-4 text-sm text-brand-clean/70",children:["Mostrando ",_.length," de ",a.length," usu\xe1rios"]})]}),t&&(0,r.jsxs)("div",{className:"bg-red-900/20 border border-red-800/50 rounded-xl p-4",children:[(0,r.jsxs)("p",{className:"text-red-400 text-sm",children:[(0,r.jsx)("strong",{children:"Erro:"})," ",t]}),(0,r.jsx)("p",{className:"text-red-400/70 text-xs mt-2",children:"Verifique se a vari\xe1vel SUPABASE_SERVICE_ROLE_KEY est\xe1 configurada no arquivo .env.local"})]}),(0,r.jsx)("div",{className:"bg-brand-royal rounded-2xl shadow-lg border border-white/10 overflow-hidden",children:0===a.length?(0,r.jsxs)("div",{className:"p-12 text-center",children:[(0,r.jsx)("p",{className:"text-brand-clean/60 text-lg mb-2",children:t?"N\xe3o foi poss\xedvel carregar os usu\xe1rios":"Nenhum usu\xe1rio cadastrado ainda"}),(0,r.jsx)("p",{className:"text-brand-clean/40 text-sm",children:t?"Verifique a configura\xe7\xe3o do banco de dados e as permiss\xf5es RLS.":"Os usu\xe1rios aparecer\xe3o aqui ap\xf3s se cadastrarem na plataforma."})]}):(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{className:"bg-brand-midnight border-b border-white/10",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-4 py-4 text-left text-xs font-display text-brand-clean uppercase tracking-wider",children:"ID Admin"}),(0,r.jsx)("th",{className:"px-4 py-4 text-left text-xs font-display text-brand-clean uppercase tracking-wider",children:"Nome"}),(0,r.jsx)("th",{className:"px-4 py-4 text-left text-xs font-display text-brand-clean uppercase tracking-wider",children:"Email"}),(0,r.jsx)("th",{className:"px-4 py-4 text-left text-xs font-display text-brand-clean uppercase tracking-wider",children:"Contato"}),(0,r.jsx)("th",{className:"px-4 py-4 text-left text-xs font-display text-brand-clean uppercase tracking-wider",children:"Plano"}),(0,r.jsx)("th",{className:"px-4 py-4 text-left text-xs font-display text-brand-clean uppercase tracking-wider",children:"Cadastrado em"}),(0,r.jsx)("th",{className:"px-4 py-4 text-left text-xs font-display text-brand-clean uppercase tracking-wider",children:"A\xe7\xf5es"})]})}),(0,r.jsx)("tbody",{className:"bg-brand-royal divide-y divide-white/10",children:0===_.length?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:7,className:"px-4 py-12 text-center text-brand-clean/60",children:"Nenhum usu\xe1rio encontrado com os filtros aplicados."})}):_.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-white/5 transition-smooth cursor-pointer",onClick:()=>f(e),children:[(0,r.jsx)("td",{className:"px-4 py-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(d.Z,{size:16,className:"text-brand-aqua"}),(0,r.jsxs)("span",{className:"text-xs font-mono text-brand-clean/80 font-semibold",children:["#",e.id_curto||e.id.substring(0,5)]})]})}),(0,r.jsx)("td",{className:"px-4 py-4",children:(0,r.jsx)("span",{className:"text-sm font-medium text-brand-clean",children:e.nome})}),(0,r.jsx)("td",{className:"px-4 py-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(l.Z,{size:16,className:"text-brand-clean/60"}),(0,r.jsx)("span",{className:"text-sm text-brand-clean/80",children:e.email})]})}),(0,r.jsx)("td",{className:"px-4 py-4",children:(0,r.jsxs)("div",{className:"space-y-1",children:[e.telefone&&(0,r.jsxs)("div",{className:"flex items-center gap-2 text-xs text-brand-clean/70",children:[(0,r.jsx)(i,{size:14}),e.telefone]}),e.whatsapp&&(0,r.jsxs)("div",{className:"flex items-center gap-2 text-xs text-brand-clean/70",children:[(0,r.jsx)(i,{size:14}),e.whatsapp]}),!e.telefone&&!e.whatsapp&&(0,r.jsx)("span",{className:"text-xs text-brand-clean/40",children:"-"})]})}),(0,r.jsx)("td",{className:"px-4 py-4",children:(0,r.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium border ".concat(z[e.plano]),children:q[e.plano]})}),(0,r.jsx)("td",{className:"px-4 py-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-2 text-sm text-brand-clean/80",children:[(0,r.jsx)(o.Z,{size:16,className:"text-brand-clean/60"}),(0,m.WU)(new Date(e.created_at),"dd/MM/yyyy",{locale:b.F})]})}),(0,r.jsx)("td",{className:"px-4 py-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("button",{onClick:a=>{a.stopPropagation(),w(k===e.id?null:e.id)},disabled:y===e.id,className:"px-2 py-1.5 bg-purple-500/20 text-purple-400 rounded-lg hover:bg-purple-500/30 transition-smooth text-xs font-medium flex items-center gap-1 disabled:opacity-50 disabled:cursor-not-allowed",title:"Alterar plano rapidamente",children:y===e.id?(0,r.jsx)(c.Z,{size:12,className:"animate-spin"}):(0,r.jsx)(x.Z,{size:12})}),k===e.id&&(0,r.jsx)("div",{className:"absolute right-0 top-full mt-1 bg-brand-midnight border border-white/20 rounded-lg shadow-xl z-50 min-w-[120px]",children:(0,r.jsxs)("div",{className:"py-1",children:["teste"!==e.plano&&(0,r.jsxs)("button",{onClick:a=>{a.stopPropagation(),S(e,"teste"),w(null)},className:"w-full px-3 py-2 text-left text-xs text-brand-clean hover:bg-white/5 transition-smooth flex items-center gap-2",children:[(0,r.jsx)("span",{className:"w-2 h-2 rounded-full bg-orange-400"}),"Teste"]}),"basico"!==e.plano&&(0,r.jsxs)("button",{onClick:a=>{a.stopPropagation(),S(e,"basico"),w(null)},className:"w-full px-3 py-2 text-left text-xs text-brand-clean hover:bg-white/5 transition-smooth flex items-center gap-2",children:[(0,r.jsx)("span",{className:"w-2 h-2 rounded-full bg-blue-400"}),"B\xe1sico"]}),"premium"!==e.plano&&(0,r.jsxs)("button",{onClick:a=>{a.stopPropagation(),S(e,"premium"),w(null)},className:"w-full px-3 py-2 text-left text-xs text-brand-clean hover:bg-white/5 transition-smooth flex items-center gap-2",children:[(0,r.jsx)("span",{className:"w-2 h-2 rounded-full bg-purple-400"}),"Premium"]})]})})]}),(0,r.jsx)("button",{onClick:a=>{a.stopPropagation(),f(e)},className:"px-3 py-1.5 bg-brand-aqua/20 text-brand-aqua rounded-lg hover:bg-brand-aqua/30 transition-smooth text-xs font-medium",title:"Ver detalhes e recuperar senha",children:"Ver Detalhes"})]})})]},e.id))})]})})}),t&&(0,r.jsxs)("div",{className:"bg-red-900/20 border border-red-800/50 rounded-2xl p-6 shadow-lg",children:[(0,r.jsx)("p",{className:"text-red-400 font-semibold mb-2",children:"Erro ao carregar usu\xe1rios"}),(0,r.jsx)("p",{className:"text-red-300/80 text-sm",children:t}),(0,r.jsx)("p",{className:"text-red-300/60 text-xs mt-2",children:"Verifique se a fun\xe7\xe3o RPC get_all_profiles est\xe1 criada no banco de dados ou configure a vari\xe1vel SUPABASE_SERVICE_ROLE_KEY."})]}),!t&&0===_.length&&(0,r.jsx)("div",{className:"bg-brand-royal rounded-2xl p-12 text-center shadow-lg border border-white/10",children:(0,r.jsx)("p",{className:"text-brand-clean/60 text-lg",children:"Nenhum usu\xe1rio encontrado"})}),j&&(0,r.jsx)(v,{usuario:j,onClose:()=>f(null)})]})}}}]);