"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3468],{53468:function(a,e,r){r.r(e),r.d(e,{createNotification:function(){return u},default:function(){return g}});var t=r(57437),n=r(2265),i=r(20173),o=r(11981),d=r(74056),s=r(3021),l=r(82549),c=r(24033),m=r(17961),b=r(82836);function g(){let[a,e]=(0,n.useState)(!1),[g,u]=(0,n.useState)([]);(0,c.useRouter)(),(0,n.useEffect)(()=>{let a=localStorage.getItem("notifications");if(a)try{let e=JSON.parse(a).map(a=>({...a,timestamp:new Date(a.timestamp),read:void 0!==a.read&&a.read}));u(e)}catch(a){console.error("Erro ao carregar notifica\xe7\xf5es:",a)}(async function(){try{let{createClient:a}=await Promise.all([r.e(889),r.e(4599)]).then(r.bind(r,34599)),e=a(),{data:{user:t}}=await e.auth.getUser();if(!t)return;let n=await fetch("/api/admin/avisos?userId=".concat(t.id),{cache:"no-store"});if(n.ok){let a=((await n.json()).avisos||[]).map(a=>({id:"admin-".concat(a.id),message:a.titulo,type:"error"===a.tipo?"warning":a.tipo,timestamp:new Date(a.created_at),read:!1}));a.length>0&&u(e=>{let r=new Set(e.map(a=>a.id)),t=[...a.filter(a=>!r.has(a.id)),...e].slice(0,10);return localStorage.setItem("notifications",JSON.stringify(t)),t})}}catch(a){console.error("Erro ao carregar avisos admin:",a)}})()},[]),(0,n.useEffect)(()=>{let a=a=>{let e={id:Date.now().toString(),message:a.detail.message,type:a.detail.type||"info",timestamp:new Date,read:!1};u(a=>{let r=[e,...a].slice(0,10);return localStorage.setItem("notifications",JSON.stringify(r)),r})};return window.addEventListener("notification",a),()=>{window.removeEventListener("notification",a)}},[]),(0,n.useEffect)(()=>{a&&u(a=>{if(a.some(a=>!a.read)){let e=a.map(a=>({...a,read:!0}));return localStorage.setItem("notifications",JSON.stringify(e)),e}return a})},[a]);let h=g.filter(a=>!a.read).length,x=a=>{switch(a){case"success":return{icon:i.Z,borderColor:"border-l-green-500",bgGradient:"from-green-50/80 via-emerald-50/60 to-green-50/80 dark:from-green-950/40 dark:via-emerald-950/30 dark:to-green-950/40",iconBg:"bg-gradient-to-br from-green-500/20 to-emerald-500/10 dark:from-green-500/30 dark:to-emerald-500/20",iconColor:"text-green-600 dark:text-green-400",glow:"shadow-green-500/30"};case"warning":return{icon:o.Z,borderColor:"border-l-orange-500",bgGradient:"from-orange-50/80 via-amber-50/60 to-orange-50/80 dark:from-orange-950/40 dark:via-amber-950/30 dark:to-orange-950/40",iconBg:"bg-gradient-to-br from-orange-500/20 to-amber-500/10 dark:from-orange-500/30 dark:to-amber-500/20",iconColor:"text-orange-600 dark:text-orange-400",glow:"shadow-orange-500/30"};default:return{icon:d.Z,borderColor:"border-l-brand-aqua",bgGradient:"from-brand-aqua/10 via-blue-50/60 to-brand-aqua/10 dark:from-brand-aqua/20 dark:via-brand-royal/40 dark:to-brand-aqua/20",iconBg:"bg-gradient-to-br from-brand-aqua/25 to-blue-500/15 dark:from-brand-aqua/35 dark:to-blue-500/25",iconColor:"text-brand-aqua dark:text-brand-aqua",glow:"shadow-brand-aqua/30"}}},f=a=>{let e=Math.floor((new Date().getTime()-a.getTime())/6e4);return e<1?"Agora":e<60?"".concat(e,"m atr\xe1s"):e<1440?"".concat(Math.floor(e/60),"h atr\xe1s"):(0,m.WU)(a,"dd/MM/yyyy HH:mm",{locale:b.F})},v=(a,e)=>{e.stopPropagation(),u(e=>{let r=e.filter(e=>e.id!==a);return localStorage.setItem("notifications",JSON.stringify(r)),r})};return(0,t.jsxs)("div",{className:"relative flex items-center",children:[(0,t.jsx)("button",{onClick:()=>e(!a),className:"relative p-2.5 text-brand-midnight dark:text-brand-clean hover:bg-brand-clean dark:hover:bg-white/10 rounded-xl transition-all duration-300 flex items-center justify-center group hover:scale-110 active:scale-95",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(s.Z,{size:24,strokeWidth:2.5,className:"relative z-10 transition-transform duration-300 group-hover:rotate-12"}),h>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-brand-aqua/20 rounded-full blur-lg animate-pulse"}),(0,t.jsx)("span",{className:"absolute -top-1 -right-1 bg-gradient-to-br from-brand-aqua to-brand-aqua/80 text-white dark:text-brand-midnight text-[11px] font-black rounded-full min-w-[22px] h-[22px] flex items-center justify-center shadow-lg ring-2 ring-white dark:ring-brand-midnight animate-bounce-subtle z-20",children:h>9?"9+":h})]})]})}),a&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"fixed inset-0 z-[90] bg-transparent",onClick:()=>e(!1)}),(0,t.jsxs)("div",{className:"fixed top-[120px] sm:top-[130px] right-2 sm:right-4 lg:right-6 w-[calc(100vw-1rem)] sm:w-[380px] max-w-[calc(100vw-1rem)] sm:max-w-[380px] bg-gradient-to-br from-white/98 via-white/95 to-gray-50/90 dark:from-brand-midnight/98 dark:via-brand-royal/95 dark:to-brand-midnight/90 backdrop-blur-2xl rounded-2xl shadow-2xl z-[95] max-h-[calc(100vh-8rem)] sm:max-h-[calc(100vh-9rem)] overflow-hidden flex flex-col animate-scale-up pointer-events-auto border border-gray-200/30 dark:border-brand-aqua/20 ring-1 ring-black/5 dark:ring-white/10",children:[(0,t.jsx)("div",{className:"relative p-4 border-b border-gray-200/40 dark:border-brand-aqua/15 bg-gradient-to-r from-brand-aqua/8 via-purple-500/5 to-brand-aqua/8 dark:from-brand-midnight/90 dark:via-brand-royal/80 dark:to-brand-midnight/90 overflow-hidden",children:(0,t.jsxs)("div",{className:"relative flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"relative",children:(0,t.jsx)("div",{className:"relative p-2 bg-gradient-to-br from-brand-aqua/20 to-brand-aqua/10 dark:from-brand-aqua/30 dark:to-brand-aqua/20 rounded-xl shadow-lg ring-1 ring-brand-aqua/20 dark:ring-brand-aqua/30",children:(0,t.jsx)(s.Z,{size:18,className:"text-brand-aqua dark:text-brand-aqua",strokeWidth:2.5})})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-display font-bold text-base text-brand-midnight dark:text-brand-clean tracking-tight",children:"Notifica\xe7\xf5es"}),h>0&&(0,t.jsxs)("p",{className:"text-xs text-brand-midnight/60 dark:text-brand-clean/60 font-medium mt-0.5",children:[h," ",1===h?"n\xe3o lida":"n\xe3o lidas"]})]})]}),g.length>0&&(0,t.jsx)("button",{onClick:()=>{u([]),localStorage.removeItem("notifications")},className:"px-3 py-1.5 text-xs font-bold text-brand-aqua hover:text-white dark:hover:text-brand-midnight transition-all rounded-lg hover:bg-gradient-to-r hover:from-brand-aqua hover:to-brand-aqua/80 dark:hover:from-brand-aqua dark:hover:to-brand-aqua/80 hover:shadow-lg hover:shadow-brand-aqua/30 hover:scale-105 active:scale-95 border border-brand-aqua/20 hover:border-brand-aqua/40",children:"Limpar todas"})]})}),(0,t.jsx)("div",{className:"overflow-y-auto flex-1 bg-gradient-to-b from-gray-50/30 via-white/20 to-gray-50/30 dark:from-brand-midnight/50 dark:via-brand-royal/30 dark:to-brand-midnight/50 custom-scrollbar",children:0===g.length?(0,t.jsxs)("div",{className:"p-12 text-center",children:[(0,t.jsx)("div",{className:"relative inline-block mb-4",children:(0,t.jsx)("div",{className:"relative bg-gradient-to-br from-brand-aqua/10 to-purple-500/5 dark:from-brand-aqua/20 dark:to-purple-500/10 p-4 rounded-2xl",children:(0,t.jsx)(s.Z,{size:40,className:"relative mx-auto text-brand-midnight/30 dark:text-brand-clean/30"})})}),(0,t.jsx)("p",{className:"text-brand-midnight/70 dark:text-brand-clean/70 text-sm font-bold mb-1",children:"Nenhuma notifica\xe7\xe3o"}),(0,t.jsx)("p",{className:"text-brand-midnight/50 dark:text-brand-clean/50 text-xs",children:"Voc\xea est\xe1 em dia! âœ¨"})]}):(0,t.jsx)("div",{className:"p-3 space-y-2",children:g.map((a,e)=>{let r=x(a.type),n=r.icon,i=!a.read;return(0,t.jsxs)("div",{className:"group relative p-3 rounded-xl border-l-[4px] ".concat(r.borderColor," bg-gradient-to-br ").concat(r.bgGradient," hover:shadow-lg ").concat(r.glow," transition-all duration-300 cursor-pointer transform hover:scale-[1.01]"),style:{animationDelay:"".concat(50*e,"ms")},children:[i&&(0,t.jsx)("div",{className:"absolute left-0 top-0 bottom-0 w-0.5 ".concat("success"===a.type?"bg-green-500":"warning"===a.type?"bg-orange-500":"bg-brand-aqua"," rounded-r-full")}),(0,t.jsxs)("div",{className:"relative flex items-start gap-3",children:[(0,t.jsx)("div",{className:"relative flex-shrink-0 ".concat(r.iconBg," rounded-lg p-2 ").concat(r.glow),children:(0,t.jsx)(n,{size:18,className:"relative z-10 ".concat(r.iconColor),strokeWidth:2.5})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"text-xs font-bold text-brand-midnight dark:text-brand-clean leading-snug mb-1.5 line-clamp-2",children:a.message}),(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,t.jsx)("span",{className:"inline-flex items-center gap-1 text-[10px] text-brand-midnight/60 dark:text-brand-clean/60 font-medium",children:f(a.timestamp)}),i&&(0,t.jsx)("span",{className:"px-1.5 py-0.5 bg-gradient-to-r from-brand-aqua/20 to-brand-aqua/10 dark:from-brand-aqua/30 dark:to-brand-aqua/20 text-brand-aqua text-[9px] font-black rounded-full uppercase tracking-wider",children:"Nova"})]})]}),(0,t.jsx)("button",{onClick:e=>v(a.id,e),className:"flex-shrink-0 p-1.5 hover:bg-black/5 dark:hover:bg-white/10 rounded-lg transition-all duration-200 opacity-0 group-hover:opacity-100 hover:scale-110 active:scale-95","aria-label":"Fechar notifica\xe7\xe3o",children:(0,t.jsx)(l.Z,{size:16,className:"text-brand-midnight/50 dark:text-brand-clean/50 hover:text-red-500 transition-colors",strokeWidth:2.5})})]})]},a.id)})})})]})]})]})}function u(a){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",r=new CustomEvent("notification",{detail:{message:a,type:e}});window.dispatchEvent(r)}}}]);