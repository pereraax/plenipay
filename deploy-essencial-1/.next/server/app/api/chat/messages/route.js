"use strict";(()=>{var e={};e.id=9402,e.ids=[9402],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},80712:(e,s,t)=>{t.r(s),t.d(s,{headerHooks:()=>h,originalPathname:()=>I,patchFetch:()=>x,requestAsyncStorage:()=>l,routeModule:()=>p,serverHooks:()=>m,staticGenerationAsyncStorage:()=>d,staticGenerationBailout:()=>g});var r={};t.r(r),t.d(r,{GET:()=>u});var a=t(95419),o=t(69108),n=t(99678),c=t(81664),i=t(78070);async function u(e){try{let e=await (0,c.eI)(),{data:{user:s}}=await e.auth.getUser();if(!s)return i.Z.json({error:"N\xe3o autenticado"},{status:401});let{data:t,error:r}=await e.from("chat_messages").select("*").eq("user_id",s.id).order("created_at",{ascending:!0});if(r)return console.error("Erro ao buscar mensagens:",r),i.Z.json({error:"Erro ao buscar mensagens"},{status:500});let a=!1,o=null;try{let{data:t,error:r}=await e.from("chat_conversations").select("*").eq("user_id",s.id).maybeSingle();r&&"PGRST116"!==r.code&&console.error("Erro ao buscar conversa:",r),t?(a=t.is_closed||!1,"assigned_agent_name"in t&&t.assigned_agent_name?(o=t.assigned_agent_name,console.log("\uD83D\uDCCB Nome do atendente encontrado no banco:",o)):console.log("ℹ️ Conversa encontrada mas sem nome de atendente atribu\xeddo")):console.log("ℹ️ Nenhuma conversa encontrada para este usu\xe1rio")}catch(e){console.error("Erro ao buscar conversa:",e?.message||e),a=!1,o=null}return i.Z.json({messages:t||[],isClosed:a,assignedAgentName:o})}catch(e){return console.error("Erro inesperado:",e),i.Z.json({error:"Erro inesperado ao buscar mensagens"},{status:500})}}let p=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/chat/messages/route",pathname:"/api/chat/messages",filename:"route",bundlePath:"app/api/chat/messages/route"},resolvedPagePath:"/Users/charllestabordas/Documents/SISTEMA DE CONTAS/app/api/chat/messages/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:l,staticGenerationAsyncStorage:d,serverHooks:m,headerHooks:h,staticGenerationBailout:g}=p,I="/api/chat/messages/route";function x(){return(0,n.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:d})}},81664:(e,s,t)=>{t.d(s,{eI:()=>n,i3:()=>c,vv:()=>i});var r=t(77497),a=t(94128),o=t(32455);let n=(0,t(40002).cache)(async()=>{let e=await (0,o.cookies)();return(0,r.createServerClient)("https://frhxqgcqmxpjpnghsvoe.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZyaHhxZ2NxbXhwanBuZ2hzdm9lIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM2NTM3NTYsImV4cCI6MjA3OTIyOTc1Nn0.p1OxLRA5DKgvetuy-IbCfYClNSjrvK6fm43aZNX3T7I",{cookies:{getAll:()=>e.getAll(),setAll(s){try{s.forEach(({name:s,value:t,options:r})=>e.set(s,t,r))}catch{}}}})});function c(){let e=process.env.SUPABASE_SERVICE_ROLE_KEY;return e?(0,a.eI)("https://frhxqgcqmxpjpnghsvoe.supabase.co",e,{auth:{autoRefreshToken:!1,persistSession:!1}}):null}function i(){return(0,a.eI)("https://frhxqgcqmxpjpnghsvoe.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZyaHhxZ2NxbXhwanBuZ2hzdm9lIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM2NTM3NTYsImV4cCI6MjA3OTIyOTc1Nn0.p1OxLRA5DKgvetuy-IbCfYClNSjrvK6fm43aZNX3T7I",{auth:{autoRefreshToken:!1,persistSession:!1}})}},50482:(e,s,t)=>{e.exports=t(20399)},40002:(e,s,t)=>{e.exports=t(50482).vendored["react-rsc"].React},95419:(e,s,t)=>{e.exports=t(30517)}};var s=require("../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[1638,2455,4128,7497,8070],()=>t(80712));module.exports=r})();