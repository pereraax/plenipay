"use strict";(()=>{var e={};e.id=9359,e.ids=[9359],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},50558:(e,a,t)=>{t.r(a),t.d(a,{headerHooks:()=>I,originalPathname:()=>h,patchFetch:()=>v,requestAsyncStorage:()=>l,routeModule:()=>c,serverHooks:()=>d,staticGenerationAsyncStorage:()=>m,staticGenerationBailout:()=>g});var r={};t.r(r),t.d(r,{POST:()=>u});var o=t(95419),s=t(69108),n=t(99678),i=t(81664),p=t(78070);async function u(e){try{let a=await (0,i.eI)(),{data:{user:t}}=await a.auth.getUser();if(!t)return p.Z.json({error:"N\xe3o autenticado"},{status:401});let{subscriptionId:r}=await e.json();if(!r)return p.Z.json({error:"ID da assinatura n\xe3o fornecido"},{status:400});let{data:o,error:s}=await a.from("profiles").select("plano, asaas_subscription_id").eq("id",t.id).single();if(s||!o)return p.Z.json({error:"Perfil n\xe3o encontrado"},{status:404});if(o.asaas_subscription_id!==r)return p.Z.json({error:"Assinatura n\xe3o pertence a este usu\xe1rio"},{status:403});let n=o.plano||"basico",u=new Date,c=new Date;c.setMonth(c.getMonth()+1);let{error:l}=await a.from("profiles").update({plano:n,plano_status:"ativo",plano_data_inicio:u.toISOString(),plano_data_fim:c.toISOString()}).eq("id",t.id);if(l)return console.error("Erro ao atualizar perfil:",l),p.Z.json({error:"Erro ao atualizar perfil: "+l.message},{status:500});return console.log("âœ… Pagamento simulado com sucesso:",{userId:t.id,subscriptionId:r,plano:n,status:"ativo",dataFim:c.toISOString()}),p.Z.json({success:!0,message:`Pagamento aprovado! Plano ${n} ativado com sucesso!`,plano:n,plano_status:"ativo",data_fim:c.toISOString()})}catch(e){return console.error("Erro ao simular aprova\xe7\xe3o de pagamento:",e),p.Z.json({error:e.message||"Erro ao simular aprova\xe7\xe3o de pagamento"},{status:500})}}let c=new o.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/pagamento/simular-aprovacao/route",pathname:"/api/pagamento/simular-aprovacao",filename:"route",bundlePath:"app/api/pagamento/simular-aprovacao/route"},resolvedPagePath:"/Users/charllestabordas/Documents/SISTEMA DE CONTAS/app/api/pagamento/simular-aprovacao/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:l,staticGenerationAsyncStorage:m,serverHooks:d,headerHooks:I,staticGenerationBailout:g}=c,h="/api/pagamento/simular-aprovacao/route";function v(){return(0,n.patchFetch)({serverHooks:d,staticGenerationAsyncStorage:m})}},81664:(e,a,t)=>{t.d(a,{eI:()=>n,i3:()=>i,vv:()=>p});var r=t(77497),o=t(94128),s=t(32455);let n=(0,t(40002).cache)(async()=>{let e=await (0,s.cookies)();return(0,r.createServerClient)("https://frhxqgcqmxpjpnghsvoe.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZyaHhxZ2NxbXhwanBuZ2hzdm9lIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM2NTM3NTYsImV4cCI6MjA3OTIyOTc1Nn0.p1OxLRA5DKgvetuy-IbCfYClNSjrvK6fm43aZNX3T7I",{cookies:{getAll:()=>e.getAll(),setAll(a){try{a.forEach(({name:a,value:t,options:r})=>e.set(a,t,r))}catch{}}}})});function i(){let e=process.env.SUPABASE_SERVICE_ROLE_KEY;return e?(0,o.eI)("https://frhxqgcqmxpjpnghsvoe.supabase.co",e,{auth:{autoRefreshToken:!1,persistSession:!1}}):null}function p(){return(0,o.eI)("https://frhxqgcqmxpjpnghsvoe.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZyaHhxZ2NxbXhwanBuZ2hzdm9lIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM2NTM3NTYsImV4cCI6MjA3OTIyOTc1Nn0.p1OxLRA5DKgvetuy-IbCfYClNSjrvK6fm43aZNX3T7I",{auth:{autoRefreshToken:!1,persistSession:!1}})}},50482:(e,a,t)=>{e.exports=t(20399)},40002:(e,a,t)=>{e.exports=t(50482).vendored["react-rsc"].React},95419:(e,a,t)=>{e.exports=t(30517)}};var a=require("../../../../webpack-runtime.js");a.C(e);var t=e=>a(a.s=e),r=a.X(0,[1638,2455,4128,7497,8070],()=>t(50558));module.exports=r})();